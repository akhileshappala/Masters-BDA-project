{"ast":null,"code":"import _slicedToArray from\"/Users/ssakhilesha/Documents/GitHub/Masters-BDA-project/website/covid19/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import HeaderCell from'./HeaderCell';import TableLoader from'./loaders/Table';import{Delta7Icon,DistrictIcon,PerLakhIcon}from'./snippets/Icons';import TableDeltaHelper from'./snippets/TableDeltaHelper';import Tooltip from'./Tooltip';import{TABLE_FADE_IN,TABLE_FADE_OUT}from'../animations';import{DISTRICT_TABLE_COUNT,STATE_NAMES,STATISTIC_CONFIGS,TABLE_STATISTICS,TABLE_STATISTICS_EXPANDED,UNASSIGNED_STATE_CODE}from'../constants';import{getStatistic,retry}from'../utils/commonFunctions';import{FoldDownIcon,InfoIcon,OrganizationIcon,PeopleIcon,PulseIcon,QuestionIcon,SortAscIcon,SortDescIcon}from'@primer/octicons-react';import classnames from'classnames';import equal from'fast-deep-equal';import produce from'immer';import{memo,useCallback,useEffect,useMemo,useState,lazy}from'react';import{ChevronLeft,ChevronsLeft,ChevronRight,ChevronsRight}from'react-feather';import{useTranslation}from'react-i18next';import{Link}from'react-router-dom';import{useTrail,useTransition,animated,config}from'react-spring';import{useKeyPressEvent,useMeasure,useSessionStorage}from'react-use';// eslint-disable-next-line\nimport worker from'workerize-loader!../workers/getDistricts';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Row=/*#__PURE__*/lazy(function(){return retry(function(){return import('./Row');});});function Table(_ref){var _this=this;var states=_ref.data,timelineDate=_ref.date,regionHighlighted=_ref.regionHighlighted,setRegionHighlighted=_ref.setRegionHighlighted,expandTable=_ref.expandTable,setExpandTable=_ref.setExpandTable,hideDistrictData=_ref.hideDistrictData,hideDistrictTestData=_ref.hideDistrictTestData,hideVaccinated=_ref.hideVaccinated,lastDataDate=_ref.lastDataDate,noDistrictDataStates=_ref.noDistrictDataStates;var _useTranslation=useTranslation(),t=_useTranslation.t;var _useSessionStorage=useSessionStorage('sortData',{sortColumn:'confirmed',isAscending:false,delta:false}),_useSessionStorage2=_slicedToArray(_useSessionStorage,2),sortData=_useSessionStorage2[0],setSortData=_useSessionStorage2[1];var _useState=useState(0),_useState2=_slicedToArray(_useState,2),page=_useState2[0],setPage=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),delta7Mode=_useState4[0],setDelta7Mode=_useState4[1];var _useMeasure=useMeasure(),_useMeasure2=_slicedToArray(_useMeasure,2),tableContainerRef=_useMeasure2[0],tableWidth=_useMeasure2[1].width;var handleSortClick=useCallback(function(statistic){if(sortData.sortColumn!==statistic){setSortData(produce(sortData,function(draftSortData){if(sortData.sortColumn==='regionName'||statistic==='regionName'){draftSortData.isAscending=!sortData.isAscending;}draftSortData.sortColumn=statistic;}));}else{setSortData(produce(sortData,function(draftSortData){draftSortData.isAscending=!sortData.isAscending;}));}},[sortData,setSortData]);var trail=useTrail(5,{from:{transform:'translate3d(0, 10px, 0)',opacity:0},to:{transform:'translate3d(0, 0px, 0)',opacity:1},config:config.wobbly});var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),allDistricts=_useState6[0],setAllDistricts=_useState6[1];var _useState7=useState('States'),_useState8=_slicedToArray(_useState7,2),tableOption=_useState8[0],setTableOption=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),isPerLakh=_useState10[0],setIsPerLakh=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),isInfoVisible=_useState12[0],setIsInfoVisible=_useState12[1];var getTableStatistic=useCallback(function(data,statistic,type){var statisticConfig=STATISTIC_CONFIGS[statistic];if(type=='total'&&(statisticConfig===null||statisticConfig===void 0?void 0:statisticConfig.onlyDelta7)){type='delta7';}if((statisticConfig===null||statisticConfig===void 0?void 0:statisticConfig.showDelta)&&type==='total'&&delta7Mode){type='delta7';}return getStatistic(data,type,statistic,{expiredDate:lastDataDate,normalizedByPopulationPer:isPerLakh?'lakh':null});},[isPerLakh,lastDataDate,delta7Mode]);var districts=useMemo(function(){if(!isPerLakh){return allDistricts;}else{return Object.keys(allDistricts||{}).filter(function(districtKey){return getStatistic(allDistricts[districtKey],'total','population')>0;}).reduce(function(res,districtKey){res[districtKey]=allDistricts[districtKey];return res;},{});}},[isPerLakh,allDistricts]);var numPages=Math.ceil(Object.keys(districts||{}).length/DISTRICT_TABLE_COUNT);var sortingFunction=useCallback(function(regionKeyA,regionKeyB){if(sortData.sortColumn!=='regionName'){var statisticConfig=STATISTIC_CONFIGS[sortData.sortColumn];var dataType=sortData.delta&&(statisticConfig===null||statisticConfig===void 0?void 0:statisticConfig.showDelta)?'delta':'total';var statisticA=getTableStatistic((districts===null||districts===void 0?void 0:districts[regionKeyA])||states[regionKeyA],sortData.sortColumn,dataType);var statisticB=getTableStatistic((districts===null||districts===void 0?void 0:districts[regionKeyB])||states[regionKeyB],sortData.sortColumn,dataType);return sortData.isAscending?statisticA-statisticB:statisticB-statisticA;}else{var _districts$regionKeyA,_districts$regionKeyB;var regionNameA=(districts===null||districts===void 0?void 0:(_districts$regionKeyA=districts[regionKeyA])===null||_districts$regionKeyA===void 0?void 0:_districts$regionKeyA.districtName)||STATE_NAMES[regionKeyA];var regionNameB=(districts===null||districts===void 0?void 0:(_districts$regionKeyB=districts[regionKeyB])===null||_districts$regionKeyB===void 0?void 0:_districts$regionKeyB.districtName)||STATE_NAMES[regionKeyB];return sortData.isAscending?regionNameA.localeCompare(regionNameB):regionNameB.localeCompare(regionNameA);}},[districts,getTableStatistic,sortData.delta,sortData.isAscending,sortData.sortColumn,states]);var _setTableOption=useCallback(function(){setTableOption(function(prevTableOption){return prevTableOption==='States'?'Districts':'States';});},[]);useEffect(function(){var workerInstance=worker();workerInstance.getDistricts(states);workerInstance.addEventListener('message',function(message){if(message.data.type!=='RPC'){setAllDistricts(message.data);workerInstance.terminate();}});},[tableOption,states]);useEffect(function(){setPage(function(p){return Math.max(0,Math.min(p,numPages-1));});},[numPages]);var handlePageClick=function handlePageClick(direction){if(Math.abs(direction)===1){setPage(Math.min(Math.max(0,page+direction),numPages-1));}else if(direction<0){setPage(0);}else if(direction>0){setPage(numPages-1);}};var transition=useTransition(isInfoVisible,{from:TABLE_FADE_OUT,enter:TABLE_FADE_IN,leave:TABLE_FADE_OUT});var tableStatistics=(expandTable?TABLE_STATISTICS_EXPANDED:TABLE_STATISTICS).filter(function(statistic){var _STATISTIC_CONFIGS$st,_STATISTIC_CONFIGS$st2;return(tableOption==='States'||((_STATISTIC_CONFIGS$st=STATISTIC_CONFIGS[statistic])===null||_STATISTIC_CONFIGS$st===void 0?void 0:_STATISTIC_CONFIGS$st.category)!=='tested'||!hideDistrictTestData)&&(((_STATISTIC_CONFIGS$st2=STATISTIC_CONFIGS[statistic])===null||_STATISTIC_CONFIGS$st2===void 0?void 0:_STATISTIC_CONFIGS$st2.category)!=='vaccinated'||!hideVaccinated);});var showDistricts=tableOption==='Districts'&&!hideDistrictData;useEffect(function(){if(!showDistricts){setPage(0);}},[showDistricts]);useKeyPressEvent('?',function(){setIsInfoVisible(!isInfoVisible);});return/*#__PURE__*/_jsxs(\"div\",{className:\"Table\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"table-top\"}),transition(function(style,item){return item&&/*#__PURE__*/_jsxs(animated.div,{className:\"table-helper\",style:style,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"helper-top\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"helper-left\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(OrganizationIcon,{size:14})}),/*#__PURE__*/_jsx(\"p\",{children:t('Toggle between States/Districts')})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-item sort\",children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(SortDescIcon,{size:14})}),/*#__PURE__*/_jsx(\"p\",{children:t('Sorted by Descending')})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-item sort\",children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(SortAscIcon,{size:14})}),/*#__PURE__*/_jsx(\"p\",{children:t('Sorted by Ascending')})]}),/*#__PURE__*/_jsx(\"div\",{className:\"info-item sort\",children:/*#__PURE__*/_jsx(TableDeltaHelper,{})}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-item notes\",children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(InfoIcon,{size:15})}),/*#__PURE__*/_jsx(\"p\",{children:t('Notes')})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"helper-right\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"info-item\",children:/*#__PURE__*/_jsx(\"p\",{children:t('Units')})}),Object.entries({'1K':3,'1L':5,'1Cr':7}).map(function(_ref2){var _ref3=_slicedToArray(_ref2,2),abbr=_ref3[0],exp=_ref3[1];return/*#__PURE__*/_jsxs(\"div\",{className:\"info-item abbr\",children:[/*#__PURE__*/_jsx(\"h5\",{children:abbr}),/*#__PURE__*/_jsxs(\"p\",{children:[\"10\",/*#__PURE__*/_jsx(\"sup\",{children:exp})]})]},abbr);})]})]}),/*#__PURE__*/_jsxs(\"h5\",{className:\"text\",children:[t('Compiled from State Govt. numbers'),\",\",' ',/*#__PURE__*/_jsxs(Link,{to:\"/about\",children:[t('know more'),\"!\"]})]})]});}),/*#__PURE__*/_jsx(\"div\",{className:\"table-container\",ref:tableContainerRef,children:/*#__PURE__*/_jsxs(\"div\",{className:\"table fadeInUp\",style:{gridTemplateColumns:\"repeat(\".concat(tableStatistics.length+1,\", auto)\")},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"row heading\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"cell heading\",onClick:handleSortClick.bind(this,'regionName'),children:[/*#__PURE__*/_jsx(\"div\",{children:t(!showDistricts?'State/UT':'District')}),sortData.sortColumn==='regionName'&&/*#__PURE__*/_jsx(\"div\",{className:'sort-icon',children:sortData.isAscending?/*#__PURE__*/_jsx(SortAscIcon,{size:12}):/*#__PURE__*/_jsx(SortDescIcon,{size:12})})]}),tableStatistics.map(function(statistic){return/*#__PURE__*/_jsx(HeaderCell,{statistic:statistic,sortData:sortData,setSortData:setSortData,handleSort:handleSortClick.bind(_this,statistic)},statistic);})]}),!showDistricts&&Object.keys(states).filter(function(stateCode){return stateCode!=='TT'&&!(stateCode===UNASSIGNED_STATE_CODE&&isPerLakh);}).sort(function(a,b){return sortingFunction(a,b);}).map(function(stateCode){return/*#__PURE__*/_jsx(Row,{data:states[stateCode],noDistrictData:noDistrictDataStates[stateCode],stateCode:stateCode,regionHighlighted:regionHighlighted,setRegionHighlighted:setRegionHighlighted,expandTable:expandTable,tableStatistics:tableStatistics,getTableStatistic:getTableStatistic,tableWidth:tableWidth},stateCode);}),showDistricts&&!districts&&/*#__PURE__*/_jsx(TableLoader,{}),showDistricts&&districts&&Object.keys(districts).sort(function(a,b){return sortingFunction(a,b);}).slice(page*DISTRICT_TABLE_COUNT,(page+1)*DISTRICT_TABLE_COUNT).map(function(districtKey){var noDistrictData=noDistrictDataStates[districts[districtKey].stateCode];return/*#__PURE__*/_jsx(Row,{data:districts[districtKey],districtName:districts[districtKey].districtName,regionHighlighted:regionHighlighted,setRegionHighlighted:setRegionHighlighted,expandTable:expandTable,tableStatistics:tableStatistics,getTableStatistic:getTableStatistic,noDistrictData:noDistrictData},districtKey);}),/*#__PURE__*/_jsx(Row,{data:states['TT'],stateCode:'TT',regionHighlighted:regionHighlighted,setRegionHighlighted:setRegionHighlighted,expandTable:expandTable,tableStatistics:tableStatistics,getTableStatistic:getTableStatistic},'TT')]})}),showDistricts&&/*#__PURE__*/_jsxs(\"div\",{className:\"paginate\",children:[/*#__PURE__*/_jsx(\"div\",{className:classnames('left',{disabled:page===0}),onClick:handlePageClick.bind(this,-2),children:/*#__PURE__*/_jsx(ChevronsLeft,{size:16})}),/*#__PURE__*/_jsx(\"div\",{className:classnames('left',{disabled:page===0}),onClick:handlePageClick.bind(this,-1),children:/*#__PURE__*/_jsx(ChevronLeft,{size:16})}),/*#__PURE__*/_jsx(\"h5\",{children:\"\".concat(page+1,\" / \").concat(numPages)}),/*#__PURE__*/_jsx(\"div\",{className:classnames('right',{disabled:page===numPages-1}),onClick:handlePageClick.bind(this,1),children:/*#__PURE__*/_jsx(ChevronRight,{size:16})}),/*#__PURE__*/_jsx(\"div\",{className:classnames('right',{disabled:page===numPages-1}),onClick:handlePageClick.bind(this,2),children:/*#__PURE__*/_jsx(ChevronsRight,{size:16})})]})]});}var isEqual=function isEqual(prevProps,currProps){var _prevProps$regionHigh,_currProps$regionHigh,_prevProps$regionHigh2,_currProps$regionHigh2;if(!equal((_prevProps$regionHigh=prevProps.regionHighlighted)===null||_prevProps$regionHigh===void 0?void 0:_prevProps$regionHigh.districtName,(_currProps$regionHigh=currProps.regionHighlighted)===null||_currProps$regionHigh===void 0?void 0:_currProps$regionHigh.districtName)){return false;}else if(!equal((_prevProps$regionHigh2=prevProps.regionHighlighted)===null||_prevProps$regionHigh2===void 0?void 0:_prevProps$regionHigh2.stateCode,(_currProps$regionHigh2=currProps.regionHighlighted)===null||_currProps$regionHigh2===void 0?void 0:_currProps$regionHigh2.stateCode)){return false;}else if(!equal(prevProps.date,currProps.date)){return false;}else if(!equal(prevProps.hideDistrictData,currProps.hideDistrictData)){return false;}else if(!equal(prevProps.hideDistrictTestData,currProps.hideDistrictTestData)){return false;}else if(!equal(prevProps.hideVaccinated,currProps.hideVaccinated)){return false;}else if(!equal(prevProps.expandTable,currProps.expandTable)){return false;}else if(!equal(prevProps.lastDataDate,currProps.lastDataDate)){return false;}else if(!equal(prevProps.data['TT'].total.confirmed,currProps.data['TT'].total.confirmed)){return false;}else if(!equal(prevProps.noDistrictDataStates,currProps.noDistrictDataStates)){return false;}else return true;};export default/*#__PURE__*/memo(Table,isEqual);","map":{"version":3,"sources":["/Users/ssakhilesha/Documents/GitHub/Masters-BDA-project/website/covid19/src/components/Table.js"],"names":["HeaderCell","TableLoader","Delta7Icon","DistrictIcon","PerLakhIcon","TableDeltaHelper","Tooltip","TABLE_FADE_IN","TABLE_FADE_OUT","DISTRICT_TABLE_COUNT","STATE_NAMES","STATISTIC_CONFIGS","TABLE_STATISTICS","TABLE_STATISTICS_EXPANDED","UNASSIGNED_STATE_CODE","getStatistic","retry","FoldDownIcon","InfoIcon","OrganizationIcon","PeopleIcon","PulseIcon","QuestionIcon","SortAscIcon","SortDescIcon","classnames","equal","produce","memo","useCallback","useEffect","useMemo","useState","lazy","ChevronLeft","ChevronsLeft","ChevronRight","ChevronsRight","useTranslation","Link","useTrail","useTransition","animated","config","useKeyPressEvent","useMeasure","useSessionStorage","worker","Row","Table","states","data","timelineDate","date","regionHighlighted","setRegionHighlighted","expandTable","setExpandTable","hideDistrictData","hideDistrictTestData","hideVaccinated","lastDataDate","noDistrictDataStates","t","sortColumn","isAscending","delta","sortData","setSortData","page","setPage","delta7Mode","setDelta7Mode","tableContainerRef","tableWidth","width","handleSortClick","statistic","draftSortData","trail","from","transform","opacity","to","wobbly","allDistricts","setAllDistricts","tableOption","setTableOption","isPerLakh","setIsPerLakh","isInfoVisible","setIsInfoVisible","getTableStatistic","type","statisticConfig","onlyDelta7","showDelta","expiredDate","normalizedByPopulationPer","districts","Object","keys","filter","districtKey","reduce","res","numPages","Math","ceil","length","sortingFunction","regionKeyA","regionKeyB","dataType","statisticA","statisticB","regionNameA","districtName","regionNameB","localeCompare","_setTableOption","prevTableOption","workerInstance","getDistricts","addEventListener","message","terminate","p","max","min","handlePageClick","direction","abs","transition","enter","leave","tableStatistics","category","showDistricts","style","item","entries","map","abbr","exp","gridTemplateColumns","bind","stateCode","sort","a","b","slice","noDistrictData","disabled","isEqual","prevProps","currProps","total","confirmed"],"mappings":"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","sourcesContent":["import HeaderCell from './HeaderCell';\nimport TableLoader from './loaders/Table';\nimport {Delta7Icon, DistrictIcon, PerLakhIcon} from './snippets/Icons';\nimport TableDeltaHelper from './snippets/TableDeltaHelper';\nimport Tooltip from './Tooltip';\n\nimport {TABLE_FADE_IN, TABLE_FADE_OUT} from '../animations';\nimport {\n  DISTRICT_TABLE_COUNT,\n  STATE_NAMES,\n  STATISTIC_CONFIGS,\n  TABLE_STATISTICS,\n  TABLE_STATISTICS_EXPANDED,\n  UNASSIGNED_STATE_CODE,\n} from '../constants';\nimport {getStatistic, retry} from '../utils/commonFunctions';\n\nimport {\n  FoldDownIcon,\n  InfoIcon,\n  OrganizationIcon,\n  PeopleIcon,\n  PulseIcon,\n  QuestionIcon,\n  SortAscIcon,\n  SortDescIcon,\n} from '@primer/octicons-react';\nimport classnames from 'classnames';\nimport equal from 'fast-deep-equal';\nimport produce from 'immer';\nimport {memo, useCallback, useEffect, useMemo, useState, lazy} from 'react';\nimport {\n  ChevronLeft,\n  ChevronsLeft,\n  ChevronRight,\n  ChevronsRight,\n} from 'react-feather';\nimport {useTranslation} from 'react-i18next';\nimport {Link} from 'react-router-dom';\nimport {useTrail, useTransition, animated, config} from 'react-spring';\nimport {useKeyPressEvent, useMeasure, useSessionStorage} from 'react-use';\n// eslint-disable-next-line\nimport worker from 'workerize-loader!../workers/getDistricts';\n\nconst Row = lazy(() => retry(() => import('./Row')));\n\nfunction Table({\n  data: states,\n  date: timelineDate,\n  regionHighlighted,\n  setRegionHighlighted,\n  expandTable,\n  setExpandTable,\n  hideDistrictData,\n  hideDistrictTestData,\n  hideVaccinated,\n  lastDataDate,\n  noDistrictDataStates,\n}) {\n  const {t} = useTranslation();\n  const [sortData, setSortData] = useSessionStorage('sortData', {\n    sortColumn: 'confirmed',\n    isAscending: false,\n    delta: false,\n  });\n  const [page, setPage] = useState(0);\n  const [delta7Mode, setDelta7Mode] = useState(false);\n\n  const [tableContainerRef, {width: tableWidth}] = useMeasure();\n\n  const handleSortClick = useCallback(\n    (statistic) => {\n      if (sortData.sortColumn !== statistic) {\n        setSortData(\n          produce(sortData, (draftSortData) => {\n            if (\n              sortData.sortColumn === 'regionName' ||\n              statistic === 'regionName'\n            ) {\n              draftSortData.isAscending = !sortData.isAscending;\n            }\n            draftSortData.sortColumn = statistic;\n          })\n        );\n      } else {\n        setSortData(\n          produce(sortData, (draftSortData) => {\n            draftSortData.isAscending = !sortData.isAscending;\n          })\n        );\n      }\n    },\n    [sortData, setSortData]\n  );\n\n  const trail = useTrail(5, {\n    from: {transform: 'translate3d(0, 10px, 0)', opacity: 0},\n    to: {transform: 'translate3d(0, 0px, 0)', opacity: 1},\n    config: config.wobbly,\n  });\n\n  const [allDistricts, setAllDistricts] = useState();\n\n  const [tableOption, setTableOption] = useState('States');\n  const [isPerLakh, setIsPerLakh] = useState(false);\n  const [isInfoVisible, setIsInfoVisible] = useState(false);\n\n  const getTableStatistic = useCallback(\n    (data, statistic, type) => {\n      const statisticConfig = STATISTIC_CONFIGS[statistic];\n      if (type == 'total' && statisticConfig?.onlyDelta7) {\n        type = 'delta7';\n      }\n\n      if (statisticConfig?.showDelta && type === 'total' && delta7Mode) {\n        type = 'delta7';\n      }\n\n      return getStatistic(data, type, statistic, {\n        expiredDate: lastDataDate,\n        normalizedByPopulationPer: isPerLakh ? 'lakh' : null,\n      });\n    },\n    [isPerLakh, lastDataDate, delta7Mode]\n  );\n\n  const districts = useMemo(() => {\n    if (!isPerLakh) {\n      return allDistricts;\n    } else {\n      return Object.keys(allDistricts || {})\n        .filter(\n          (districtKey) =>\n            getStatistic(allDistricts[districtKey], 'total', 'population') > 0\n        )\n        .reduce((res, districtKey) => {\n          res[districtKey] = allDistricts[districtKey];\n          return res;\n        }, {});\n    }\n  }, [isPerLakh, allDistricts]);\n\n  const numPages = Math.ceil(\n    Object.keys(districts || {}).length / DISTRICT_TABLE_COUNT\n  );\n\n  const sortingFunction = useCallback(\n    (regionKeyA, regionKeyB) => {\n      if (sortData.sortColumn !== 'regionName') {\n        const statisticConfig = STATISTIC_CONFIGS[sortData.sortColumn];\n        const dataType =\n          sortData.delta && statisticConfig?.showDelta ? 'delta' : 'total';\n\n        const statisticA = getTableStatistic(\n          districts?.[regionKeyA] || states[regionKeyA],\n          sortData.sortColumn,\n          dataType\n        );\n        const statisticB = getTableStatistic(\n          districts?.[regionKeyB] || states[regionKeyB],\n          sortData.sortColumn,\n          dataType\n        );\n        return sortData.isAscending\n          ? statisticA - statisticB\n          : statisticB - statisticA;\n      } else {\n        const regionNameA =\n          districts?.[regionKeyA]?.districtName || STATE_NAMES[regionKeyA];\n        const regionNameB =\n          districts?.[regionKeyB]?.districtName || STATE_NAMES[regionKeyB];\n        return sortData.isAscending\n          ? regionNameA.localeCompare(regionNameB)\n          : regionNameB.localeCompare(regionNameA);\n      }\n    },\n    [\n      districts,\n      getTableStatistic,\n      sortData.delta,\n      sortData.isAscending,\n      sortData.sortColumn,\n      states,\n    ]\n  );\n\n  const _setTableOption = useCallback(() => {\n    setTableOption((prevTableOption) =>\n      prevTableOption === 'States' ? 'Districts' : 'States'\n    );\n  }, []);\n\n  useEffect(() => {\n    const workerInstance = worker();\n    workerInstance.getDistricts(states);\n    workerInstance.addEventListener('message', (message) => {\n      if (message.data.type !== 'RPC') {\n        setAllDistricts(message.data);\n        workerInstance.terminate();\n      }\n    });\n  }, [tableOption, states]);\n\n  useEffect(() => {\n    setPage((p) => Math.max(0, Math.min(p, numPages - 1)));\n  }, [numPages]);\n\n  const handlePageClick = (direction) => {\n    if (Math.abs(direction) === 1) {\n      setPage(Math.min(Math.max(0, page + direction), numPages - 1));\n    } else if (direction < 0) {\n      setPage(0);\n    } else if (direction > 0) {\n      setPage(numPages - 1);\n    }\n  };\n\n  const transition = useTransition(isInfoVisible, {\n    from: TABLE_FADE_OUT,\n    enter: TABLE_FADE_IN,\n    leave: TABLE_FADE_OUT,\n  });\n\n  const tableStatistics = (\n    expandTable ? TABLE_STATISTICS_EXPANDED : TABLE_STATISTICS\n  ).filter(\n    (statistic) =>\n      (tableOption === 'States' ||\n        STATISTIC_CONFIGS[statistic]?.category !== 'tested' ||\n        !hideDistrictTestData) &&\n      (STATISTIC_CONFIGS[statistic]?.category !== 'vaccinated' ||\n        !hideVaccinated)\n  );\n\n  const showDistricts = tableOption === 'Districts' && !hideDistrictData;\n\n  useEffect(() => {\n    if (!showDistricts) {\n      setPage(0);\n    }\n  }, [showDistricts]);\n\n  useKeyPressEvent('?', () => {\n    setIsInfoVisible(!isInfoVisible);\n  });\n\n  return (\n    <div className=\"Table\">\n      <div className=\"table-top\"></div>\n\n      {transition(\n        (style, item) =>\n          item && (\n            <animated.div className=\"table-helper\" {...{style}}>\n              <div className=\"helper-top\">\n                <div className=\"helper-left\">\n                  <div className=\"info-item\">\n                    <div>\n                      <OrganizationIcon size={14} />\n                    </div>\n                    <p>{t('Toggle between States/Districts')}</p>\n                  </div>\n\n                  <div className=\"info-item sort\">\n                    <div>\n                      <SortDescIcon size={14} />\n                    </div>\n                    <p>{t('Sorted by Descending')}</p>\n                  </div>\n\n                  <div className=\"info-item sort\">\n                    <div>\n                      <SortAscIcon size={14} />\n                    </div>\n                    <p>{t('Sorted by Ascending')}</p>\n                  </div>\n\n                  <div className=\"info-item sort\">\n                    <TableDeltaHelper />\n                  </div>\n\n                  <div className=\"info-item notes\">\n                    <div>\n                      <InfoIcon size={15} />\n                    </div>\n                    <p>{t('Notes')}</p>\n                  </div>\n                </div>\n\n                <div className=\"helper-right\">\n                  <div className=\"info-item\">\n                    <p>{t('Units')}</p>\n                  </div>\n                  {Object.entries({'1K': 3, '1L': 5, '1Cr': 7}).map(\n                    ([abbr, exp]) => (\n                      <div className=\"info-item abbr\" key={abbr}>\n                        <h5>{abbr}</h5>\n                        <p>\n                          10\n                          <sup>{exp}</sup>\n                        </p>\n                      </div>\n                    )\n                  )}\n                </div>\n              </div>\n\n              <h5 className=\"text\">\n                {t('Compiled from State Govt. numbers')},{' '}\n                <Link to=\"/about\">{t('know more')}!</Link>\n              </h5>\n            </animated.div>\n          )\n      )}\n\n      <div className=\"table-container\" ref={tableContainerRef}>\n        <div\n          className=\"table fadeInUp\"\n          style={{\n            gridTemplateColumns: `repeat(${tableStatistics.length + 1}, auto)`,\n          }}\n        >\n          <div className=\"row heading\">\n            <div\n              className=\"cell heading\"\n              onClick={handleSortClick.bind(this, 'regionName')}\n            >\n              <div>{t(!showDistricts ? 'State/UT' : 'District')}</div>\n              {sortData.sortColumn === 'regionName' && (\n                <div className={'sort-icon'}>\n                  {sortData.isAscending ? (\n                    <SortAscIcon size={12} />\n                  ) : (\n                    <SortDescIcon size={12} />\n                  )}\n                </div>\n              )}\n            </div>\n\n            {tableStatistics.map((statistic) => (\n              <HeaderCell\n                key={statistic}\n                {...{\n                  statistic,\n                  sortData,\n                  setSortData,\n                }}\n                handleSort={handleSortClick.bind(this, statistic)}\n              />\n            ))}\n          </div>\n\n          {!showDistricts &&\n            Object.keys(states)\n              .filter(\n                (stateCode) =>\n                  stateCode !== 'TT' &&\n                  !(stateCode === UNASSIGNED_STATE_CODE && isPerLakh)\n              )\n              .sort((a, b) => sortingFunction(a, b))\n              .map((stateCode) => {\n                return (\n                  <Row\n                    key={stateCode}\n                    data={states[stateCode]}\n                    noDistrictData={noDistrictDataStates[stateCode]}\n                    {...{\n                      stateCode,\n                      regionHighlighted,\n                      setRegionHighlighted,\n                      expandTable,\n                      tableStatistics,\n                      getTableStatistic,\n                      tableWidth,\n                    }}\n                  />\n                );\n              })}\n\n          {showDistricts && !districts && <TableLoader />}\n\n          {showDistricts &&\n            districts &&\n            Object.keys(districts)\n              .sort((a, b) => sortingFunction(a, b))\n              .slice(\n                page * DISTRICT_TABLE_COUNT,\n                (page + 1) * DISTRICT_TABLE_COUNT\n              )\n              .map((districtKey) => {\n                const noDistrictData =\n                  noDistrictDataStates[districts[districtKey].stateCode];\n                return (\n                  <Row\n                    key={districtKey}\n                    data={districts[districtKey]}\n                    districtName={districts[districtKey].districtName}\n                    {...{\n                      regionHighlighted,\n                      setRegionHighlighted,\n                      expandTable,\n                      tableStatistics,\n                      getTableStatistic,\n                      noDistrictData,\n                    }}\n                  />\n                );\n              })}\n\n          <Row\n            key={'TT'}\n            data={states['TT']}\n            stateCode={'TT'}\n            {...{\n              regionHighlighted,\n              setRegionHighlighted,\n              expandTable,\n              tableStatistics,\n              getTableStatistic,\n            }}\n          />\n        </div>\n      </div>\n      {showDistricts && (\n        <div className=\"paginate\">\n          <div\n            className={classnames('left', {disabled: page === 0})}\n            onClick={handlePageClick.bind(this, -2)}\n          >\n            <ChevronsLeft size={16} />\n          </div>\n          <div\n            className={classnames('left', {disabled: page === 0})}\n            onClick={handlePageClick.bind(this, -1)}\n          >\n            <ChevronLeft size={16} />\n          </div>\n          <h5>{`${page + 1} / ${numPages}`}</h5>\n          <div\n            className={classnames('right', {disabled: page === numPages - 1})}\n            onClick={handlePageClick.bind(this, 1)}\n          >\n            <ChevronRight size={16} />\n          </div>\n          <div\n            className={classnames('right', {disabled: page === numPages - 1})}\n            onClick={handlePageClick.bind(this, 2)}\n          >\n            <ChevronsRight size={16} />\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n\nconst isEqual = (prevProps, currProps) => {\n  if (\n    !equal(\n      prevProps.regionHighlighted?.districtName,\n      currProps.regionHighlighted?.districtName\n    )\n  ) {\n    return false;\n  } else if (\n    !equal(\n      prevProps.regionHighlighted?.stateCode,\n      currProps.regionHighlighted?.stateCode\n    )\n  ) {\n    return false;\n  } else if (!equal(prevProps.date, currProps.date)) {\n    return false;\n  } else if (!equal(prevProps.hideDistrictData, currProps.hideDistrictData)) {\n    return false;\n  } else if (\n    !equal(prevProps.hideDistrictTestData, currProps.hideDistrictTestData)\n  ) {\n    return false;\n  } else if (!equal(prevProps.hideVaccinated, currProps.hideVaccinated)) {\n    return false;\n  } else if (!equal(prevProps.expandTable, currProps.expandTable)) {\n    return false;\n  } else if (!equal(prevProps.lastDataDate, currProps.lastDataDate)) {\n    return false;\n  } else if (\n    !equal(\n      prevProps.data['TT'].total.confirmed,\n      currProps.data['TT'].total.confirmed\n    )\n  ) {\n    return false;\n  } else if (\n    !equal(prevProps.noDistrictDataStates, currProps.noDistrictDataStates)\n  ) {\n    return false;\n  } else return true;\n};\n\nexport default memo(Table, isEqual);\n"]},"metadata":{},"sourceType":"module"}