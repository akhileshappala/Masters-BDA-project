{"ast":null,"code":"import _slicedToArray from\"/Users/ssakhilesha/Documents/GitHub/Masters-BDA-project/website/covid19/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import Cell from'./Cell';import DistrictRow from'./DistrictRow';import HeaderCell from'./HeaderCell';import Tooltip from'./Tooltip';import{STATE_NAMES,STATISTIC_CONFIGS,UNKNOWN_DISTRICT_KEY}from'../constants';import{capitalize,formatLastUpdated}from'../utils/commonFunctions';import{AlertIcon,ClockIcon,SortAscIcon,SortDescIcon,FoldUpIcon,GraphIcon,InfoIcon}from'@primer/octicons-react';import classnames from'classnames';import equal from'fast-deep-equal';import produce from'immer';import{memo,useCallback,useRef,useState}from'react';import{useTranslation}from'react-i18next';import{useHistory}from'react-router-dom';import{useSessionStorage}from'react-use';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function Row(_ref){var _data$meta,_this=this;var data=_ref.data,tableStatistics=_ref.tableStatistics,stateCode=_ref.stateCode,districtName=_ref.districtName,regionHighlighted=_ref.regionHighlighted,setRegionHighlighted=_ref.setRegionHighlighted,expandTable=_ref.expandTable,getTableStatistic=_ref.getTableStatistic,tableWidth=_ref.tableWidth,noDistrictData=_ref.noDistrictData;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),showDistricts=_useState2[0],setShowDistricts=_useState2[1];var _useSessionStorage=useSessionStorage('districtSortData',{sortColumn:'confirmed',isAscending:false,delta:false}),_useSessionStorage2=_slicedToArray(_useSessionStorage,2),sortData=_useSessionStorage2[0],setSortData=_useSessionStorage2[1];var history=useHistory();var _useTranslation=useTranslation(),t=_useTranslation.t;var rowElement=useRef();var handleSortClick=useCallback(function(statistic){if(sortData.sortColumn!==statistic){setSortData(produce(sortData,function(draftSortData){if(sortData.sortColumn==='districtName'||statistic==='districtName'){draftSortData.isAscending=!sortData.isAscending;}draftSortData.sortColumn=statistic;}));}else{setSortData(produce(sortData,function(draftSortData){draftSortData.isAscending=!sortData.isAscending;}));}},[sortData,setSortData]);var sortingFunction=useCallback(function(districtNameA,districtNameB){if(sortData.sortColumn!=='districtName'){var statisticConfig=STATISTIC_CONFIGS[sortData.sortColumn];var dataType=sortData.delta&&(statisticConfig===null||statisticConfig===void 0?void 0:statisticConfig.showDelta)?'delta':'total';var statisticA=getTableStatistic(data.districts[districtNameA],sortData.sortColumn,dataType);var statisticB=getTableStatistic(data.districts[districtNameB],sortData.sortColumn,dataType);return sortData.isAscending?statisticA-statisticB:statisticB-statisticA;}else{return sortData.isAscending?districtNameA.localeCompare(districtNameB):districtNameB.localeCompare(districtNameA);}},[sortData,data,getTableStatistic]);var highlightState=useCallback(function(){if(stateCode){if(regionHighlighted.stateCode!==stateCode){setRegionHighlighted(produce(regionHighlighted,function(draftRegionHighlighted){draftRegionHighlighted.stateCode=stateCode;draftRegionHighlighted.districtName=null;}));}}else if(districtName){if(regionHighlighted.districtName!==districtName||regionHighlighted.stateCode!==data.stateCode){setRegionHighlighted(produce(regionHighlighted,function(draftRegionHighlighted){draftRegionHighlighted.stateCode=data.stateCode;draftRegionHighlighted.districtName=districtName;}));}}},[data.stateCode,districtName,regionHighlighted,setRegionHighlighted,stateCode]);var _setShowDistrict=useCallback(function(){if(data.districts){setShowDistricts(!showDistricts);}},[showDistricts,data]);var districtNameStr=t(districtName);if(districtName===UNKNOWN_DISTRICT_KEY){districtNameStr=\"\".concat(t(UNKNOWN_DISTRICT_KEY),\" [\").concat(t(STATE_NAMES[data.stateCode]),\"]\");}var handleStatePageClick=useCallback(function(stateCode){history.push(\"state/\".concat(stateCode));},[history]);var handleCollapse=useCallback(function(){setShowDistricts(false);rowElement.current.scrollIntoView({block:'start'});},[]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:classnames('row',{'is-total':stateCode==='TT'},{'is-highlighted':stateCode&&(regionHighlighted===null||regionHighlighted===void 0?void 0:regionHighlighted.stateCode)===stateCode||districtName&&(regionHighlighted===null||regionHighlighted===void 0?void 0:regionHighlighted.districtName)===districtName&&(regionHighlighted===null||regionHighlighted===void 0?void 0:regionHighlighted.stateCode)===data.stateCode}),onMouseEnter:highlightState,onClick:_setShowDistrict,ref:rowElement,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"cell\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"state-name fadeInUp\",children:t(STATE_NAMES[stateCode])||districtNameStr}),(data===null||data===void 0?void 0:(_data$meta=data.meta)===null||_data$meta===void 0?void 0:_data$meta.notes)&&/*#__PURE__*/_jsx(Tooltip,{message:data.meta.notes,children:/*#__PURE__*/_jsx(InfoIcon,{size:16})})]}),tableStatistics.map(function(statistic){return/*#__PURE__*/_jsx(Cell,{noDistrictData:!stateCode&&districtName!==UNKNOWN_DISTRICT_KEY&&noDistrictData,data:data,statistic:statistic,getTableStatistic:getTableStatistic},statistic);})]}),showDistricts&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"state-meta\",style:{width:tableWidth},children:/*#__PURE__*/_jsx(\"div\",{className:\"state-meta-top\"})}),/*#__PURE__*/_jsxs(\"div\",{className:classnames('row','heading'),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"cell heading\",onClick:handleSortClick.bind(this,'districtName'),children:[/*#__PURE__*/_jsx(\"div\",{className:\"district-name\",children:t('District')}),sortData.sortColumn==='districtName'&&/*#__PURE__*/_jsx(\"div\",{className:'sort-icon',children:sortData.isAscending?/*#__PURE__*/_jsx(SortAscIcon,{size:12}):/*#__PURE__*/_jsx(SortDescIcon,{size:12})})]}),tableStatistics.map(function(statistic){return/*#__PURE__*/_jsx(HeaderCell,{statistic:statistic,sortData:sortData,setSortData:setSortData,handleSort:handleSortClick.bind(_this,statistic)},statistic);})]})]}),showDistricts&&Object.keys(data.districts||{}).sort(function(a,b){return sortingFunction(a,b);}).map(function(districtName){return/*#__PURE__*/_jsx(DistrictRow,{data:data.districts[districtName],noDistrictData:districtName!==UNKNOWN_DISTRICT_KEY&&noDistrictData,tableStatistics:tableStatistics,districtName:districtName,regionHighlighted:regionHighlighted,setRegionHighlighted:setRegionHighlighted,stateCode:stateCode,expandTable:expandTable,getTableStatistic:getTableStatistic},districtName);}),showDistricts&&/*#__PURE__*/_jsx(\"div\",{className:\"spacer-row\",style:{width:tableWidth},children:/*#__PURE__*/_jsxs(\"div\",{className:\"spacer\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"End of \".concat(t(STATE_NAMES[stateCode]),\"'s districts\")}),/*#__PURE__*/_jsx(\"div\",{className:\"fold\",onClick:handleCollapse,children:/*#__PURE__*/_jsx(FoldUpIcon,{})})]})})]});}var isEqual=function isEqual(prevProps,currProps){var _prevProps$data,_currProps$data,_prevProps$data2,_currProps$data2;if(!equal((_prevProps$data=prevProps.data)===null||_prevProps$data===void 0?void 0:_prevProps$data.total,(_currProps$data=currProps.data)===null||_currProps$data===void 0?void 0:_currProps$data.total)){return false;}else if(!equal((_prevProps$data2=prevProps.data)===null||_prevProps$data2===void 0?void 0:_prevProps$data2.delta,(_currProps$data2=currProps.data)===null||_currProps$data2===void 0?void 0:_currProps$data2.delta)){return false;}else if(!equal(prevProps.regionHighlighted.stateCode,currProps.regionHighlighted.stateCode)&&equal(prevProps.regionHighlighted.stateCode,prevProps.stateCode)||equal(currProps.regionHighlighted.stateCode,currProps.stateCode)){return false;}else if(!equal(prevProps.regionHighlighted.districtName,currProps.regionHighlighted.districtName)&&equal(prevProps.regionHighlighted.districtName,prevProps.districtName)||equal(currProps.regionHighlighted.districtName,currProps.districtName)){return false;}else if(!equal(prevProps.expandTable,currProps.expandTable)){return false;}else if(!equal(prevProps.noDistrictData,currProps.noDistrictData)){return false;}else if(!equal(prevProps.tableWidth,currProps.tableWidth)){return false;}else if(!equal(prevProps.getTableStatistic,currProps.getTableStatistic)){return false;}else if(!equal(prevProps.tableStatistics,currProps.tableStatistics)){return false;}else return true;};export default/*#__PURE__*/memo(Row,isEqual);","map":{"version":3,"sources":["/Users/ssakhilesha/Documents/GitHub/Masters-BDA-project/website/covid19/src/components/Row.js"],"names":["Cell","DistrictRow","HeaderCell","Tooltip","STATE_NAMES","STATISTIC_CONFIGS","UNKNOWN_DISTRICT_KEY","capitalize","formatLastUpdated","AlertIcon","ClockIcon","SortAscIcon","SortDescIcon","FoldUpIcon","GraphIcon","InfoIcon","classnames","equal","produce","memo","useCallback","useRef","useState","useTranslation","useHistory","useSessionStorage","Row","data","tableStatistics","stateCode","districtName","regionHighlighted","setRegionHighlighted","expandTable","getTableStatistic","tableWidth","noDistrictData","showDistricts","setShowDistricts","sortColumn","isAscending","delta","sortData","setSortData","history","t","rowElement","handleSortClick","statistic","draftSortData","sortingFunction","districtNameA","districtNameB","statisticConfig","dataType","showDelta","statisticA","districts","statisticB","localeCompare","highlightState","draftRegionHighlighted","_setShowDistrict","districtNameStr","handleStatePageClick","push","handleCollapse","current","scrollIntoView","block","meta","notes","map","width","bind","Object","keys","sort","a","b","isEqual","prevProps","currProps","total"],"mappings":"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","sourcesContent":["import Cell from './Cell';\nimport DistrictRow from './DistrictRow';\nimport HeaderCell from './HeaderCell';\nimport Tooltip from './Tooltip';\n\nimport {\n  STATE_NAMES,\n  STATISTIC_CONFIGS,\n  UNKNOWN_DISTRICT_KEY,\n} from '../constants';\nimport {capitalize, formatLastUpdated} from '../utils/commonFunctions';\n\nimport {\n  AlertIcon,\n  ClockIcon,\n  SortAscIcon,\n  SortDescIcon,\n  FoldUpIcon,\n  GraphIcon,\n  InfoIcon,\n} from '@primer/octicons-react';\nimport classnames from 'classnames';\nimport equal from 'fast-deep-equal';\nimport produce from 'immer';\nimport {memo, useCallback, useRef, useState} from 'react';\nimport {useTranslation} from 'react-i18next';\nimport {useHistory} from 'react-router-dom';\nimport {useSessionStorage} from 'react-use';\n\nfunction Row({\n  data,\n  tableStatistics,\n  stateCode,\n  districtName,\n  regionHighlighted,\n  setRegionHighlighted,\n  expandTable,\n  getTableStatistic,\n  tableWidth,\n  noDistrictData,\n}) {\n  const [showDistricts, setShowDistricts] = useState(false);\n  const [sortData, setSortData] = useSessionStorage('districtSortData', {\n    sortColumn: 'confirmed',\n    isAscending: false,\n    delta: false,\n  });\n\n  const history = useHistory();\n  const {t} = useTranslation();\n\n  const rowElement = useRef();\n\n  const handleSortClick = useCallback(\n    (statistic) => {\n      if (sortData.sortColumn !== statistic) {\n        setSortData(\n          produce(sortData, (draftSortData) => {\n            if (\n              sortData.sortColumn === 'districtName' ||\n              statistic === 'districtName'\n            ) {\n              draftSortData.isAscending = !sortData.isAscending;\n            }\n            draftSortData.sortColumn = statistic;\n          })\n        );\n      } else {\n        setSortData(\n          produce(sortData, (draftSortData) => {\n            draftSortData.isAscending = !sortData.isAscending;\n          })\n        );\n      }\n    },\n    [sortData, setSortData]\n  );\n\n  const sortingFunction = useCallback(\n    (districtNameA, districtNameB) => {\n      if (sortData.sortColumn !== 'districtName') {\n        const statisticConfig = STATISTIC_CONFIGS[sortData.sortColumn];\n        const dataType =\n          sortData.delta && statisticConfig?.showDelta ? 'delta' : 'total';\n\n        const statisticA = getTableStatistic(\n          data.districts[districtNameA],\n          sortData.sortColumn,\n          dataType\n        );\n        const statisticB = getTableStatistic(\n          data.districts[districtNameB],\n          sortData.sortColumn,\n          dataType\n        );\n        return sortData.isAscending\n          ? statisticA - statisticB\n          : statisticB - statisticA;\n      } else {\n        return sortData.isAscending\n          ? districtNameA.localeCompare(districtNameB)\n          : districtNameB.localeCompare(districtNameA);\n      }\n    },\n    [sortData, data, getTableStatistic]\n  );\n\n  const highlightState = useCallback(() => {\n    if (stateCode) {\n      if (regionHighlighted.stateCode !== stateCode) {\n        setRegionHighlighted(\n          produce(regionHighlighted, (draftRegionHighlighted) => {\n            draftRegionHighlighted.stateCode = stateCode;\n            draftRegionHighlighted.districtName = null;\n          })\n        );\n      }\n    } else if (districtName) {\n      if (\n        regionHighlighted.districtName !== districtName ||\n        regionHighlighted.stateCode !== data.stateCode\n      ) {\n        setRegionHighlighted(\n          produce(regionHighlighted, (draftRegionHighlighted) => {\n            draftRegionHighlighted.stateCode = data.stateCode;\n            draftRegionHighlighted.districtName = districtName;\n          })\n        );\n      }\n    }\n  }, [\n    data.stateCode,\n    districtName,\n    regionHighlighted,\n    setRegionHighlighted,\n    stateCode,\n  ]);\n\n  const _setShowDistrict = useCallback(() => {\n    if (data.districts) {\n      setShowDistricts(!showDistricts);\n    }\n  }, [showDistricts, data]);\n\n  let districtNameStr = t(districtName);\n  if (districtName === UNKNOWN_DISTRICT_KEY) {\n    districtNameStr = `${t(UNKNOWN_DISTRICT_KEY)} [${t(\n      STATE_NAMES[data.stateCode]\n    )}]`;\n  }\n\n  const handleStatePageClick = useCallback(\n    (stateCode) => {\n      history.push(`state/${stateCode}`);\n    },\n    [history]\n  );\n\n  const handleCollapse = useCallback(() => {\n    setShowDistricts(false);\n    rowElement.current.scrollIntoView({\n      block: 'start',\n    });\n  }, []);\n\n  return (\n    <>\n      <div\n        className={classnames(\n          'row',\n          {'is-total': stateCode === 'TT'},\n          {\n            'is-highlighted':\n              (stateCode && regionHighlighted?.stateCode === stateCode) ||\n              (districtName &&\n                regionHighlighted?.districtName === districtName &&\n                regionHighlighted?.stateCode === data.stateCode),\n          }\n        )}\n        onMouseEnter={highlightState}\n        onClick={_setShowDistrict}\n        ref={rowElement}\n      >\n        <div className=\"cell\">\n          <div className=\"state-name fadeInUp\">\n            {t(STATE_NAMES[stateCode]) || districtNameStr}\n          </div>\n          {data?.meta?.notes && (\n            <Tooltip message={data.meta.notes}>\n              <InfoIcon size={16} />\n            </Tooltip>\n          )}\n        </div>\n\n        {tableStatistics.map((statistic) => (\n          <Cell\n            key={statistic}\n            noDistrictData={\n              !stateCode &&\n              districtName !== UNKNOWN_DISTRICT_KEY &&\n              noDistrictData\n            }\n            {...{\n              data,\n              statistic,\n              getTableStatistic,\n            }}\n          />\n        ))}\n      </div>\n\n      {showDistricts && (\n        <>\n          <div className=\"state-meta\" style={{width: tableWidth}}>\n            <div className=\"state-meta-top\">\n              \n            </div>\n          </div>\n\n          <div className={classnames('row', 'heading')}>\n            <div\n              className=\"cell heading\"\n              onClick={handleSortClick.bind(this, 'districtName')}\n            >\n              <div className=\"district-name\">{t('District')}</div>\n              {sortData.sortColumn === 'districtName' && (\n                <div className={'sort-icon'}>\n                  {sortData.isAscending ? (\n                    <SortAscIcon size={12} />\n                  ) : (\n                    <SortDescIcon size={12} />\n                  )}\n                </div>\n              )}\n            </div>\n\n            {tableStatistics.map((statistic) => (\n              <HeaderCell\n                key={statistic}\n                {...{statistic, sortData, setSortData}}\n                handleSort={handleSortClick.bind(this, statistic)}\n              />\n            ))}\n          </div>\n        </>\n      )}\n\n      {showDistricts &&\n        Object.keys(data.districts || {})\n          .sort((a, b) => sortingFunction(a, b))\n          .map((districtName) => (\n            <DistrictRow\n              data={data.districts[districtName]}\n              key={districtName}\n              noDistrictData={\n                districtName !== UNKNOWN_DISTRICT_KEY && noDistrictData\n              }\n              {...{\n                tableStatistics,\n                districtName,\n                regionHighlighted,\n                setRegionHighlighted,\n                stateCode,\n                expandTable,\n                getTableStatistic,\n              }}\n            />\n          ))}\n\n      {showDistricts && (\n        <div className=\"spacer-row\" style={{width: tableWidth}}>\n          <div className=\"spacer\">\n            <p>{`End of ${t(STATE_NAMES[stateCode])}'s districts`}</p>\n            <div className=\"fold\" onClick={handleCollapse}>\n              <FoldUpIcon />\n            </div>\n          </div>\n        </div>\n      )}\n    </>\n  );\n}\n\nconst isEqual = (prevProps, currProps) => {\n  if (!equal(prevProps.data?.total, currProps.data?.total)) {\n    return false;\n  } else if (!equal(prevProps.data?.delta, currProps.data?.delta)) {\n    return false;\n  } else if (\n    (!equal(\n      prevProps.regionHighlighted.stateCode,\n      currProps.regionHighlighted.stateCode\n    ) &&\n      equal(prevProps.regionHighlighted.stateCode, prevProps.stateCode)) ||\n    equal(currProps.regionHighlighted.stateCode, currProps.stateCode)\n  ) {\n    return false;\n  } else if (\n    (!equal(\n      prevProps.regionHighlighted.districtName,\n      currProps.regionHighlighted.districtName\n    ) &&\n      equal(\n        prevProps.regionHighlighted.districtName,\n        prevProps.districtName\n      )) ||\n    equal(currProps.regionHighlighted.districtName, currProps.districtName)\n  ) {\n    return false;\n  } else if (!equal(prevProps.expandTable, currProps.expandTable)) {\n    return false;\n  } else if (!equal(prevProps.noDistrictData, currProps.noDistrictData)) {\n    return false;\n  } else if (!equal(prevProps.tableWidth, currProps.tableWidth)) {\n    return false;\n  } else if (!equal(prevProps.getTableStatistic, currProps.getTableStatistic)) {\n    return false;\n  } else if (!equal(prevProps.tableStatistics, currProps.tableStatistics)) {\n    return false;\n  } else return true;\n};\n\nexport default memo(Row, isEqual);\n"]},"metadata":{},"sourceType":"module"}