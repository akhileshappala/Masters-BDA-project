{"ast":null,"code":"var _jsxFileName = \"/Users/ssakhilesha/Documents/GitHub/Masters-BDA-project/website /covid19india-react-master/src/components/Timeline.js\",\n    _s = $RefreshSig$();\n\nimport { formatDate, getIndiaDateISO, getIndiaDateYesterdayISO, retry } from '../utils/commonFunctions';\nimport { CalendarIcon } from '@primer/octicons-react';\nimport classnames from 'classnames';\nimport equal from 'fast-deep-equal';\nimport { useKeenSlider } from 'keen-slider/react';\nimport 'keen-slider/keen-slider.min.css';\nimport { memo, useEffect, useMemo, useRef, useState, lazy, Suspense } from 'react';\nimport ReactDOM from 'react-dom';\nimport { FastForward, Play, Pause } from 'react-feather';\nimport { useTranslation } from 'react-i18next';\nimport { useTransition, animated } from 'react-spring';\nimport { useClickAway, useKeyPressEvent } from 'react-use';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Calendar = /*#__PURE__*/lazy(_c = () => retry(() => import('./Calendar')));\n_c2 = Calendar;\nconst wheelSize = 18;\nconst slidesPerView = 1;\nconst slideDegree = 360 / wheelSize;\nconst distanceThreshold = 5;\nconst autoPlayDelay = 2500;\n\nfunction Timeline({\n  date,\n  setDate,\n  dates,\n  isTimelineMode,\n  setIsTimelineMode\n}) {\n  _s();\n\n  const {\n    t\n  } = useTranslation();\n  const [sliderState, setSliderState] = useState(null);\n  const [play, setPlay] = useState(false);\n  const [showCalendar, setShowCalendar] = useState(false);\n  const timelineRef = useRef();\n  const timer = useRef();\n  useClickAway(timelineRef, () => {\n    setShowCalendar(false);\n  });\n  const [sliderRef, slider] = useKeenSlider({\n    initial: date === '' ? Math.max(0, dates.length - 2) : dates.indexOf(date),\n    dragSpeed: (val, instance) => {\n      const width = instance.details().widthOrHeight;\n      return val * (width / (width / 2 * Math.tan(slideDegree * (Math.PI / 180))) / slidesPerView);\n    },\n    move: s => {\n      setSliderState(s.details());\n    },\n    afterChange: s => {\n      const slide = s.details().absoluteSlide;\n\n      if (slide === s.details().size - 1) {\n        ReactDOM.unstable_batchedUpdates(() => {\n          setIsTimelineMode(false);\n          setShowCalendar(false);\n          setDate('');\n        });\n      } else {\n        setDate(dates[slide]);\n      }\n    },\n    mode: 'free-snap',\n    slides: dates.length,\n    slidesPerView\n  });\n  const [radius, setRadius] = useState(0);\n  useEffect(() => {\n    if (slider) setRadius(slider.details().widthOrHeight);\n  }, [slider]);\n\n  const formatSlideDate = date => {\n    if (date === getIndiaDateISO()) return t('Today');else if (date === getIndiaDateYesterdayISO()) return t('Yesterday');\n    return formatDate(date, 'dd MMM y');\n  };\n\n  const slideValues = useMemo(() => {\n    if (!sliderState) return [];\n    const values = [];\n\n    for (let i = 0; i < sliderState.size; i++) {\n      const distance = sliderState.positions[i].distance * slidesPerView;\n      const rotate = Math.abs(distance) > wheelSize / 2 ? 180 : distance * (360 / wheelSize);\n      const style = {\n        transform: `rotateY(${rotate}deg) translateZ(${radius}px)`,\n        WebkitTransform: `rotateY(${rotate}deg) translateZ(${radius}px)`\n      };\n      const className = i === sliderState.absoluteSlide ? 'current' : '';\n      const slide = sliderState.absoluteSlide + Math.round(distance);\n      if (Math.abs(distance) < distanceThreshold) values.push({\n        className,\n        style,\n        slide\n      });\n    }\n\n    return values;\n  }, [sliderState, radius]);\n  useKeyPressEvent('ArrowLeft', () => {\n    if (slider) slider.prev();\n  });\n  useKeyPressEvent('ArrowRight', () => {\n    if (slider) slider.next();\n  });\n  useKeyPressEvent('Escape', () => {\n    setPlay(false);\n    if (slider) slider.moveToSlide(sliderState.size - 1);\n  });\n  useKeyPressEvent('Enter', () => {\n    setPlay(!play);\n  });\n\n  const handleClick = index => {\n    if (index === (sliderState === null || sliderState === void 0 ? void 0 : sliderState.absoluteSlide)) {\n      setShowCalendar(!showCalendar);\n    } else if (slider) {\n      slider.moveToSlide(index);\n    }\n  };\n\n  const timeline = {\n    '2020-03-25': t('Beginning of Lockdown Phase 1'),\n    '2020-04-14': t('End of Lockdown Phase 1'),\n    '2020-04-15': t('Beginning of Lockdown Phase 2'),\n    '2020-05-03': t('End of Lockdown Phase 2'),\n    '2020-05-04': t('Beginning of Lockdown Phase 3'),\n    '2020-05-17': t('End of Lockdown Phase 3'),\n    '2020-05-18': t('Beginning of Lockdown Phase 4'),\n    '2020-05-31': t('End of Lockdown Phase 4'),\n    '2020-06-01': t('Beginning of Lockdown Phase 5'),\n    '2020-11-20': 'ðŸ¥€'\n  };\n  useEffect(() => {\n    timer.current = setInterval(() => {\n      if (play && slider) {\n        slider.next();\n      }\n    }, autoPlayDelay);\n    return () => {\n      clearInterval(timer.current);\n    };\n  }, [play, slider]);\n\n  const handleWheel = event => {\n    if (slider) {\n      if (event.deltaX > 0) {\n        slider.next();\n      } else if (event.deltaX < 0) {\n        slider.prev();\n      }\n    }\n  };\n\n  const transitions = useTransition(showCalendar, {\n    from: {\n      pointerEvents: 'none',\n      paddingTop: 0,\n      marginBottom: 0,\n      height: 0,\n      opacity: 0\n    },\n    enter: {\n      pointerEvents: 'all',\n      paddingTop: 36,\n      marginBottom: 400,\n      opacity: 1\n    },\n    leave: {\n      pointerEvents: 'none',\n      paddingTop: 0,\n      marginBottom: 0,\n      height: 0,\n      opacity: 0\n    },\n    config: {\n      mass: 1,\n      tension: 100,\n      friction: 15\n    }\n  });\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: 'Timeline',\n    ref: timelineRef,\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"actions timeline fadeInUp\",\n      onWheel: handleWheel,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: 'wheel-buttons',\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: 'wheel-button left',\n          onClick: handleClick.bind(this, 0),\n          children: /*#__PURE__*/_jsxDEV(FastForward, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 206,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 202,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: classnames('wheel-button', {\n            active: play\n          }),\n          onClick: setPlay.bind(this, !play),\n          children: play ? /*#__PURE__*/_jsxDEV(Pause, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 212,\n            columnNumber: 21\n          }, this) : /*#__PURE__*/_jsxDEV(Play, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 212,\n            columnNumber: 33\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 208,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"wheel-button\",\n          onClick: handleClick.bind(this, dates.length - 1),\n          children: /*#__PURE__*/_jsxDEV(FastForward, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 218,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 214,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: 'wheel',\n        ref: sliderRef,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"wheel__inner\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"wheel__slides\",\n            children: slideValues.map(({\n              className,\n              style,\n              slide\n            }) => /*#__PURE__*/_jsxDEV(\"div\", {\n              className: `wheel__slide`,\n              style: style,\n              children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n                className,\n                onClick: handleClick.bind(this, slide),\n                children: formatSlideDate(dates[slide])\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 226,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: classnames('calendar-icon', {\n                  show: slide === (sliderState === null || sliderState === void 0 ? void 0 : sliderState.absoluteSlide)\n                }),\n                onClick: setShowCalendar.bind(this, !showCalendar),\n                children: slide !== sliderState.size - 1 && /*#__PURE__*/_jsxDEV(CalendarIcon, {\n                  size: 12\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 236,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 229,\n                columnNumber: 19\n              }, this)]\n            }, slide, true, {\n              fileName: _jsxFileName,\n              lineNumber: 225,\n              columnNumber: 17\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 223,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 222,\n          columnNumber: 11\n        }, this), slideValues.map(({\n          slide\n        }) => Object.keys(timeline).includes(dates[slide]) && /*#__PURE__*/_jsxDEV(\"h5\", {\n          className: classnames('highlight', {\n            current: slide === (sliderState === null || sliderState === void 0 ? void 0 : sliderState.absoluteSlide)\n          }),\n          children: timeline[dates[slide]]\n        }, slide, false, {\n          fileName: _jsxFileName,\n          lineNumber: 246,\n          columnNumber: 17\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 221,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Suspense, {\n      fallback: /*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 258,\n        columnNumber: 27\n      }, this),\n      children: transitions((style, item) => item && /*#__PURE__*/_jsxDEV(animated.div, {\n        style,\n        children: /*#__PURE__*/_jsxDEV(Calendar, {\n          date,\n          dates,\n          slider\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 263,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 262,\n        columnNumber: 15\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 258,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 199,\n    columnNumber: 5\n  }, this);\n}\n\n_s(Timeline, \"daIEcht8iaEA927Z7ovDrnKEMps=\", false, function () {\n  return [useTranslation, useClickAway, useKeenSlider, useKeyPressEvent, useKeyPressEvent, useKeyPressEvent, useKeyPressEvent, useTransition];\n});\n\n_c3 = Timeline;\n\nconst isEqual = (prevProps, currProps) => {\n  if (!equal(currProps.date, prevProps.date)) {\n    return false;\n  } else if (!equal(currProps.isTimelineMode, prevProps.isTimelineMode)) {\n    return false;\n  } else if (!equal(currProps.dates, prevProps.dates)) {\n    return false;\n  }\n\n  return true;\n};\n\nexport default _c4 = /*#__PURE__*/memo(Timeline, isEqual);\n\nvar _c, _c2, _c3, _c4;\n\n$RefreshReg$(_c, \"Calendar$lazy\");\n$RefreshReg$(_c2, \"Calendar\");\n$RefreshReg$(_c3, \"Timeline\");\n$RefreshReg$(_c4, \"%default%\");","map":{"version":3,"sources":["/Users/ssakhilesha/Documents/GitHub/Masters-BDA-project/website /covid19india-react-master/src/components/Timeline.js"],"names":["formatDate","getIndiaDateISO","getIndiaDateYesterdayISO","retry","CalendarIcon","classnames","equal","useKeenSlider","memo","useEffect","useMemo","useRef","useState","lazy","Suspense","ReactDOM","FastForward","Play","Pause","useTranslation","useTransition","animated","useClickAway","useKeyPressEvent","Calendar","wheelSize","slidesPerView","slideDegree","distanceThreshold","autoPlayDelay","Timeline","date","setDate","dates","isTimelineMode","setIsTimelineMode","t","sliderState","setSliderState","play","setPlay","showCalendar","setShowCalendar","timelineRef","timer","sliderRef","slider","initial","Math","max","length","indexOf","dragSpeed","val","instance","width","details","widthOrHeight","tan","PI","move","s","afterChange","slide","absoluteSlide","size","unstable_batchedUpdates","mode","slides","radius","setRadius","formatSlideDate","slideValues","values","i","distance","positions","rotate","abs","style","transform","WebkitTransform","className","round","push","prev","next","moveToSlide","handleClick","index","timeline","current","setInterval","clearInterval","handleWheel","event","deltaX","transitions","from","pointerEvents","paddingTop","marginBottom","height","opacity","enter","leave","config","mass","tension","friction","bind","active","map","show","Object","keys","includes","item","isEqual","prevProps","currProps"],"mappings":"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","sourcesContent":["import {\n  formatDate,\n  getIndiaDateISO,\n  getIndiaDateYesterdayISO,\n  retry,\n} from '../utils/commonFunctions';\n\nimport {CalendarIcon} from '@primer/octicons-react';\nimport classnames from 'classnames';\nimport equal from 'fast-deep-equal';\nimport {useKeenSlider} from 'keen-slider/react';\nimport 'keen-slider/keen-slider.min.css';\nimport {\n  memo,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n  lazy,\n  Suspense,\n} from 'react';\nimport ReactDOM from 'react-dom';\nimport {FastForward, Play, Pause} from 'react-feather';\nimport {useTranslation} from 'react-i18next';\nimport {useTransition, animated} from 'react-spring';\nimport {useClickAway, useKeyPressEvent} from 'react-use';\n\nconst Calendar = lazy(() => retry(() => import('./Calendar')));\n\nconst wheelSize = 18;\nconst slidesPerView = 1;\nconst slideDegree = 360 / wheelSize;\nconst distanceThreshold = 5;\nconst autoPlayDelay = 2500;\n\nfunction Timeline({date, setDate, dates, isTimelineMode, setIsTimelineMode}) {\n  const {t} = useTranslation();\n\n  const [sliderState, setSliderState] = useState(null);\n  const [play, setPlay] = useState(false);\n  const [showCalendar, setShowCalendar] = useState(false);\n  const timelineRef = useRef();\n  const timer = useRef();\n\n  useClickAway(timelineRef, () => {\n    setShowCalendar(false);\n  });\n\n  const [sliderRef, slider] = useKeenSlider({\n    initial: date === '' ? Math.max(0, dates.length - 2) : dates.indexOf(date),\n    dragSpeed: (val, instance) => {\n      const width = instance.details().widthOrHeight;\n      return (\n        val *\n        (width /\n          ((width / 2) * Math.tan(slideDegree * (Math.PI / 180))) /\n          slidesPerView)\n      );\n    },\n    move: (s) => {\n      setSliderState(s.details());\n    },\n    afterChange: (s) => {\n      const slide = s.details().absoluteSlide;\n      if (slide === s.details().size - 1) {\n        ReactDOM.unstable_batchedUpdates(() => {\n          setIsTimelineMode(false);\n          setShowCalendar(false);\n          setDate('');\n        });\n      } else {\n        setDate(dates[slide]);\n      }\n    },\n    mode: 'free-snap',\n    slides: dates.length,\n    slidesPerView,\n  });\n\n  const [radius, setRadius] = useState(0);\n\n  useEffect(() => {\n    if (slider) setRadius(slider.details().widthOrHeight);\n  }, [slider]);\n\n  const formatSlideDate = (date) => {\n    if (date === getIndiaDateISO()) return t('Today');\n    else if (date === getIndiaDateYesterdayISO()) return t('Yesterday');\n    return formatDate(date, 'dd MMM y');\n  };\n\n  const slideValues = useMemo(() => {\n    if (!sliderState) return [];\n    const values = [];\n    for (let i = 0; i < sliderState.size; i++) {\n      const distance = sliderState.positions[i].distance * slidesPerView;\n      const rotate =\n        Math.abs(distance) > wheelSize / 2 ? 180 : distance * (360 / wheelSize);\n      const style = {\n        transform: `rotateY(${rotate}deg) translateZ(${radius}px)`,\n        WebkitTransform: `rotateY(${rotate}deg) translateZ(${radius}px)`,\n      };\n      const className = i === sliderState.absoluteSlide ? 'current' : '';\n      const slide = sliderState.absoluteSlide + Math.round(distance);\n      if (Math.abs(distance) < distanceThreshold)\n        values.push({className, style, slide});\n    }\n    return values;\n  }, [sliderState, radius]);\n\n  useKeyPressEvent('ArrowLeft', () => {\n    if (slider) slider.prev();\n  });\n\n  useKeyPressEvent('ArrowRight', () => {\n    if (slider) slider.next();\n  });\n\n  useKeyPressEvent('Escape', () => {\n    setPlay(false);\n    if (slider) slider.moveToSlide(sliderState.size - 1);\n  });\n\n  useKeyPressEvent('Enter', () => {\n    setPlay(!play);\n  });\n\n  const handleClick = (index) => {\n    if (index === sliderState?.absoluteSlide) {\n      setShowCalendar(!showCalendar);\n    } else if (slider) {\n      slider.moveToSlide(index);\n    }\n  };\n\n  const timeline = {\n    '2020-03-25': t('Beginning of Lockdown Phase 1'),\n    '2020-04-14': t('End of Lockdown Phase 1'),\n    '2020-04-15': t('Beginning of Lockdown Phase 2'),\n    '2020-05-03': t('End of Lockdown Phase 2'),\n    '2020-05-04': t('Beginning of Lockdown Phase 3'),\n    '2020-05-17': t('End of Lockdown Phase 3'),\n    '2020-05-18': t('Beginning of Lockdown Phase 4'),\n    '2020-05-31': t('End of Lockdown Phase 4'),\n    '2020-06-01': t('Beginning of Lockdown Phase 5'),\n    '2020-11-20': 'ðŸ¥€',\n  };\n\n  useEffect(() => {\n    timer.current = setInterval(() => {\n      if (play && slider) {\n        slider.next();\n      }\n    }, autoPlayDelay);\n    return () => {\n      clearInterval(timer.current);\n    };\n  }, [play, slider]);\n\n  const handleWheel = (event) => {\n    if (slider) {\n      if (event.deltaX > 0) {\n        slider.next();\n      } else if (event.deltaX < 0) {\n        slider.prev();\n      }\n    }\n  };\n\n  const transitions = useTransition(showCalendar, {\n    from: {\n      pointerEvents: 'none',\n      paddingTop: 0,\n      marginBottom: 0,\n      height: 0,\n      opacity: 0,\n    },\n    enter: {\n      pointerEvents: 'all',\n      paddingTop: 36,\n      marginBottom: 400,\n      opacity: 1,\n    },\n    leave: {\n      pointerEvents: 'none',\n      paddingTop: 0,\n      marginBottom: 0,\n      height: 0,\n      opacity: 0,\n    },\n    config: {\n      mass: 1,\n      tension: 100,\n      friction: 15,\n    },\n  });\n\n  return (\n    <div className={'Timeline'} ref={timelineRef}>\n      <div className=\"actions timeline fadeInUp\" onWheel={handleWheel}>\n        <div className={'wheel-buttons'}>\n          <div\n            className={'wheel-button left'}\n            onClick={handleClick.bind(this, 0)}\n          >\n            <FastForward />\n          </div>\n          <div\n            className={classnames('wheel-button', {active: play})}\n            onClick={setPlay.bind(this, !play)}\n          >\n            {play ? <Pause /> : <Play />}\n          </div>\n          <div\n            className=\"wheel-button\"\n            onClick={handleClick.bind(this, dates.length - 1)}\n          >\n            <FastForward />\n          </div>\n        </div>\n        <div className={'wheel'} ref={sliderRef}>\n          <div className=\"wheel__inner\">\n            <div className=\"wheel__slides\">\n              {slideValues.map(({className, style, slide}) => (\n                <div className={`wheel__slide`} style={style} key={slide}>\n                  <h5 {...{className}} onClick={handleClick.bind(this, slide)}>\n                    {formatSlideDate(dates[slide])}\n                  </h5>\n                  <div\n                    className={classnames('calendar-icon', {\n                      show: slide === sliderState?.absoluteSlide,\n                    })}\n                    onClick={setShowCalendar.bind(this, !showCalendar)}\n                  >\n                    {slide !== sliderState.size - 1 && (\n                      <CalendarIcon size={12} />\n                    )}\n                  </div>\n                </div>\n              ))}\n            </div>\n          </div>\n          {slideValues.map(\n            ({slide}) =>\n              Object.keys(timeline).includes(dates[slide]) && (\n                <h5\n                  className={classnames('highlight', {\n                    current: slide === sliderState?.absoluteSlide,\n                  })}\n                  key={slide}\n                >\n                  {timeline[dates[slide]]}\n                </h5>\n              )\n          )}\n        </div>\n      </div>\n      <Suspense fallback={<div />}>\n        {transitions(\n          (style, item) =>\n            item && (\n              <animated.div {...{style}}>\n                <Calendar {...{date, dates, slider}} />\n              </animated.div>\n            )\n        )}\n      </Suspense>\n    </div>\n  );\n}\n\nconst isEqual = (prevProps, currProps) => {\n  if (!equal(currProps.date, prevProps.date)) {\n    return false;\n  } else if (!equal(currProps.isTimelineMode, prevProps.isTimelineMode)) {\n    return false;\n  } else if (!equal(currProps.dates, prevProps.dates)) {\n    return false;\n  }\n  return true;\n};\n\nexport default memo(Timeline, isEqual);\n"]},"metadata":{},"sourceType":"module"}