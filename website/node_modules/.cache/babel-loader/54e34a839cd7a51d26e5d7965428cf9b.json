{"ast":null,"code":"import _slicedToArray from\"/Users/ssakhilesha/Documents/GitHub/Masters-BDA-project/website/covid19/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{formatDate,getIndiaDateISO,getIndiaDateYesterdayISO,retry}from'../utils/commonFunctions';import{CalendarIcon}from'@primer/octicons-react';import classnames from'classnames';import equal from'fast-deep-equal';import{useKeenSlider}from'keen-slider/react';import'keen-slider/keen-slider.min.css';import{memo,useEffect,useMemo,useRef,useState,lazy,Suspense}from'react';import ReactDOM from'react-dom';import{FastForward,Play,Pause}from'react-feather';import{useTranslation}from'react-i18next';import{useTransition,animated}from'react-spring';import{useClickAway,useKeyPressEvent}from'react-use';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Calendar=/*#__PURE__*/lazy(function(){return retry(function(){return import('./Calendar');});});var wheelSize=18;var slidesPerView=1;var slideDegree=360/wheelSize;var distanceThreshold=5;var autoPlayDelay=2500;function Timeline(_ref){var _this=this;var date=_ref.date,setDate=_ref.setDate,dates=_ref.dates,isTimelineMode=_ref.isTimelineMode,setIsTimelineMode=_ref.setIsTimelineMode;var _useTranslation=useTranslation(),t=_useTranslation.t;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),sliderState=_useState2[0],setSliderState=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),play=_useState4[0],setPlay=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),showCalendar=_useState6[0],setShowCalendar=_useState6[1];var timelineRef=useRef();var timer=useRef();useClickAway(timelineRef,function(){setShowCalendar(false);});var _useKeenSlider=useKeenSlider({initial:date===''?Math.max(0,dates.length-2):dates.indexOf(date),dragSpeed:function dragSpeed(val,instance){var width=instance.details().widthOrHeight;return val*(width/(width/2*Math.tan(slideDegree*(Math.PI/180)))/slidesPerView);},move:function move(s){setSliderState(s.details());},afterChange:function afterChange(s){var slide=s.details().absoluteSlide;if(slide===s.details().size-1){ReactDOM.unstable_batchedUpdates(function(){setIsTimelineMode(false);setShowCalendar(false);setDate('');});}else{setDate(dates[slide]);}},mode:'free-snap',slides:dates.length,slidesPerView:slidesPerView}),_useKeenSlider2=_slicedToArray(_useKeenSlider,2),sliderRef=_useKeenSlider2[0],slider=_useKeenSlider2[1];var _useState7=useState(0),_useState8=_slicedToArray(_useState7,2),radius=_useState8[0],setRadius=_useState8[1];useEffect(function(){if(slider)setRadius(slider.details().widthOrHeight);},[slider]);var formatSlideDate=function formatSlideDate(date){if(date===getIndiaDateISO())return t('Today');else if(date===getIndiaDateYesterdayISO())return t('Yesterday');return formatDate(date,'dd MMM y');};var slideValues=useMemo(function(){if(!sliderState)return[];var values=[];for(var i=0;i<sliderState.size;i++){var distance=sliderState.positions[i].distance*slidesPerView;var rotate=Math.abs(distance)>wheelSize/2?180:distance*(360/wheelSize);var style={transform:\"rotateY(\".concat(rotate,\"deg) translateZ(\").concat(radius,\"px)\"),WebkitTransform:\"rotateY(\".concat(rotate,\"deg) translateZ(\").concat(radius,\"px)\")};var className=i===sliderState.absoluteSlide?'current':'';var slide=sliderState.absoluteSlide+Math.round(distance);if(Math.abs(distance)<distanceThreshold)values.push({className:className,style:style,slide:slide});}return values;},[sliderState,radius]);useKeyPressEvent('ArrowLeft',function(){if(slider)slider.prev();});useKeyPressEvent('ArrowRight',function(){if(slider)slider.next();});useKeyPressEvent('Escape',function(){setPlay(false);if(slider)slider.moveToSlide(sliderState.size-1);});useKeyPressEvent('Enter',function(){setPlay(!play);});var handleClick=function handleClick(index){if(index===(sliderState===null||sliderState===void 0?void 0:sliderState.absoluteSlide)){setShowCalendar(!showCalendar);}else if(slider){slider.moveToSlide(index);}};var timeline={'2020-03-25':t('Beginning of Lockdown Phase 1'),'2020-04-14':t('End of Lockdown Phase 1'),'2020-04-15':t('Beginning of Lockdown Phase 2'),'2020-05-03':t('End of Lockdown Phase 2'),'2020-05-04':t('Beginning of Lockdown Phase 3'),'2020-05-17':t('End of Lockdown Phase 3'),'2020-05-18':t('Beginning of Lockdown Phase 4'),'2020-05-31':t('End of Lockdown Phase 4'),'2020-06-01':t('Beginning of Lockdown Phase 5'),'2020-11-20':'ðŸ¥€'};useEffect(function(){timer.current=setInterval(function(){if(play&&slider){slider.next();}},autoPlayDelay);return function(){clearInterval(timer.current);};},[play,slider]);var handleWheel=function handleWheel(event){if(slider){if(event.deltaX>0){slider.next();}else if(event.deltaX<0){slider.prev();}}};var transitions=useTransition(showCalendar,{from:{pointerEvents:'none',paddingTop:0,marginBottom:0,height:0,opacity:0},enter:{pointerEvents:'all',paddingTop:36,marginBottom:400,opacity:1},leave:{pointerEvents:'none',paddingTop:0,marginBottom:0,height:0,opacity:0},config:{mass:1,tension:100,friction:15}});return/*#__PURE__*/_jsxs(\"div\",{className:'Timeline',ref:timelineRef,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"actions timeline fadeInUp\",onWheel:handleWheel,children:[/*#__PURE__*/_jsxs(\"div\",{className:'wheel-buttons',children:[/*#__PURE__*/_jsx(\"div\",{className:'wheel-button left',onClick:handleClick.bind(this,0),children:/*#__PURE__*/_jsx(FastForward,{})}),/*#__PURE__*/_jsx(\"div\",{className:classnames('wheel-button',{active:play}),onClick:setPlay.bind(this,!play),children:play?/*#__PURE__*/_jsx(Pause,{}):/*#__PURE__*/_jsx(Play,{})}),/*#__PURE__*/_jsx(\"div\",{className:\"wheel-button\",onClick:handleClick.bind(this,dates.length-1),children:/*#__PURE__*/_jsx(FastForward,{})})]}),/*#__PURE__*/_jsxs(\"div\",{className:'wheel',ref:sliderRef,children:[/*#__PURE__*/_jsx(\"div\",{className:\"wheel__inner\",children:/*#__PURE__*/_jsx(\"div\",{className:\"wheel__slides\",children:slideValues.map(function(_ref2){var className=_ref2.className,style=_ref2.style,slide=_ref2.slide;return/*#__PURE__*/_jsxs(\"div\",{className:\"wheel__slide\",style:style,children:[/*#__PURE__*/_jsx(\"h5\",{className:className,onClick:handleClick.bind(_this,slide),children:formatSlideDate(dates[slide])}),/*#__PURE__*/_jsx(\"div\",{className:classnames('calendar-icon',{show:slide===(sliderState===null||sliderState===void 0?void 0:sliderState.absoluteSlide)}),onClick:setShowCalendar.bind(_this,!showCalendar),children:slide!==sliderState.size-1&&/*#__PURE__*/_jsx(CalendarIcon,{size:12})})]},slide);})})}),slideValues.map(function(_ref3){var slide=_ref3.slide;return Object.keys(timeline).includes(dates[slide])&&/*#__PURE__*/_jsx(\"h5\",{className:classnames('highlight',{current:slide===(sliderState===null||sliderState===void 0?void 0:sliderState.absoluteSlide)}),children:timeline[dates[slide]]},slide);})]})]}),/*#__PURE__*/_jsx(Suspense,{fallback:/*#__PURE__*/_jsx(\"div\",{}),children:transitions(function(style,item){return item&&/*#__PURE__*/_jsx(animated.div,{style:style,children:/*#__PURE__*/_jsx(Calendar,{date:date,dates:dates,slider:slider})});})})]});}var isEqual=function isEqual(prevProps,currProps){if(!equal(currProps.date,prevProps.date)){return false;}else if(!equal(currProps.isTimelineMode,prevProps.isTimelineMode)){return false;}else if(!equal(currProps.dates,prevProps.dates)){return false;}return true;};export default/*#__PURE__*/memo(Timeline,isEqual);","map":{"version":3,"sources":["/Users/ssakhilesha/Documents/GitHub/Masters-BDA-project/website/covid19/src/components/Timeline.js"],"names":["formatDate","getIndiaDateISO","getIndiaDateYesterdayISO","retry","CalendarIcon","classnames","equal","useKeenSlider","memo","useEffect","useMemo","useRef","useState","lazy","Suspense","ReactDOM","FastForward","Play","Pause","useTranslation","useTransition","animated","useClickAway","useKeyPressEvent","Calendar","wheelSize","slidesPerView","slideDegree","distanceThreshold","autoPlayDelay","Timeline","date","setDate","dates","isTimelineMode","setIsTimelineMode","t","sliderState","setSliderState","play","setPlay","showCalendar","setShowCalendar","timelineRef","timer","initial","Math","max","length","indexOf","dragSpeed","val","instance","width","details","widthOrHeight","tan","PI","move","s","afterChange","slide","absoluteSlide","size","unstable_batchedUpdates","mode","slides","sliderRef","slider","radius","setRadius","formatSlideDate","slideValues","values","i","distance","positions","rotate","abs","style","transform","WebkitTransform","className","round","push","prev","next","moveToSlide","handleClick","index","timeline","current","setInterval","clearInterval","handleWheel","event","deltaX","transitions","from","pointerEvents","paddingTop","marginBottom","height","opacity","enter","leave","config","mass","tension","friction","bind","active","map","show","Object","keys","includes","item","isEqual","prevProps","currProps"],"mappings":"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","sourcesContent":["import {\n  formatDate,\n  getIndiaDateISO,\n  getIndiaDateYesterdayISO,\n  retry,\n} from '../utils/commonFunctions';\n\nimport {CalendarIcon} from '@primer/octicons-react';\nimport classnames from 'classnames';\nimport equal from 'fast-deep-equal';\nimport {useKeenSlider} from 'keen-slider/react';\nimport 'keen-slider/keen-slider.min.css';\nimport {\n  memo,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n  lazy,\n  Suspense,\n} from 'react';\nimport ReactDOM from 'react-dom';\nimport {FastForward, Play, Pause} from 'react-feather';\nimport {useTranslation} from 'react-i18next';\nimport {useTransition, animated} from 'react-spring';\nimport {useClickAway, useKeyPressEvent} from 'react-use';\n\nconst Calendar = lazy(() => retry(() => import('./Calendar')));\n\nconst wheelSize = 18;\nconst slidesPerView = 1;\nconst slideDegree = 360 / wheelSize;\nconst distanceThreshold = 5;\nconst autoPlayDelay = 2500;\n\nfunction Timeline({date, setDate, dates, isTimelineMode, setIsTimelineMode}) {\n  const {t} = useTranslation();\n\n  const [sliderState, setSliderState] = useState(null);\n  const [play, setPlay] = useState(false);\n  const [showCalendar, setShowCalendar] = useState(false);\n  const timelineRef = useRef();\n  const timer = useRef();\n\n  useClickAway(timelineRef, () => {\n    setShowCalendar(false);\n  });\n\n  const [sliderRef, slider] = useKeenSlider({\n    initial: date === '' ? Math.max(0, dates.length - 2) : dates.indexOf(date),\n    dragSpeed: (val, instance) => {\n      const width = instance.details().widthOrHeight;\n      return (\n        val *\n        (width /\n          ((width / 2) * Math.tan(slideDegree * (Math.PI / 180))) /\n          slidesPerView)\n      );\n    },\n    move: (s) => {\n      setSliderState(s.details());\n    },\n    afterChange: (s) => {\n      const slide = s.details().absoluteSlide;\n      if (slide === s.details().size - 1) {\n        ReactDOM.unstable_batchedUpdates(() => {\n          setIsTimelineMode(false);\n          setShowCalendar(false);\n          setDate('');\n        });\n      } else {\n        setDate(dates[slide]);\n      }\n    },\n    mode: 'free-snap',\n    slides: dates.length,\n    slidesPerView,\n  });\n\n  const [radius, setRadius] = useState(0);\n\n  useEffect(() => {\n    if (slider) setRadius(slider.details().widthOrHeight);\n  }, [slider]);\n\n  const formatSlideDate = (date) => {\n    if (date === getIndiaDateISO()) return t('Today');\n    else if (date === getIndiaDateYesterdayISO()) return t('Yesterday');\n    return formatDate(date, 'dd MMM y');\n  };\n\n  const slideValues = useMemo(() => {\n    if (!sliderState) return [];\n    const values = [];\n    for (let i = 0; i < sliderState.size; i++) {\n      const distance = sliderState.positions[i].distance * slidesPerView;\n      const rotate =\n        Math.abs(distance) > wheelSize / 2 ? 180 : distance * (360 / wheelSize);\n      const style = {\n        transform: `rotateY(${rotate}deg) translateZ(${radius}px)`,\n        WebkitTransform: `rotateY(${rotate}deg) translateZ(${radius}px)`,\n      };\n      const className = i === sliderState.absoluteSlide ? 'current' : '';\n      const slide = sliderState.absoluteSlide + Math.round(distance);\n      if (Math.abs(distance) < distanceThreshold)\n        values.push({className, style, slide});\n    }\n    return values;\n  }, [sliderState, radius]);\n\n  useKeyPressEvent('ArrowLeft', () => {\n    if (slider) slider.prev();\n  });\n\n  useKeyPressEvent('ArrowRight', () => {\n    if (slider) slider.next();\n  });\n\n  useKeyPressEvent('Escape', () => {\n    setPlay(false);\n    if (slider) slider.moveToSlide(sliderState.size - 1);\n  });\n\n  useKeyPressEvent('Enter', () => {\n    setPlay(!play);\n  });\n\n  const handleClick = (index) => {\n    if (index === sliderState?.absoluteSlide) {\n      setShowCalendar(!showCalendar);\n    } else if (slider) {\n      slider.moveToSlide(index);\n    }\n  };\n\n  const timeline = {\n    '2020-03-25': t('Beginning of Lockdown Phase 1'),\n    '2020-04-14': t('End of Lockdown Phase 1'),\n    '2020-04-15': t('Beginning of Lockdown Phase 2'),\n    '2020-05-03': t('End of Lockdown Phase 2'),\n    '2020-05-04': t('Beginning of Lockdown Phase 3'),\n    '2020-05-17': t('End of Lockdown Phase 3'),\n    '2020-05-18': t('Beginning of Lockdown Phase 4'),\n    '2020-05-31': t('End of Lockdown Phase 4'),\n    '2020-06-01': t('Beginning of Lockdown Phase 5'),\n    '2020-11-20': 'ðŸ¥€',\n  };\n\n  useEffect(() => {\n    timer.current = setInterval(() => {\n      if (play && slider) {\n        slider.next();\n      }\n    }, autoPlayDelay);\n    return () => {\n      clearInterval(timer.current);\n    };\n  }, [play, slider]);\n\n  const handleWheel = (event) => {\n    if (slider) {\n      if (event.deltaX > 0) {\n        slider.next();\n      } else if (event.deltaX < 0) {\n        slider.prev();\n      }\n    }\n  };\n\n  const transitions = useTransition(showCalendar, {\n    from: {\n      pointerEvents: 'none',\n      paddingTop: 0,\n      marginBottom: 0,\n      height: 0,\n      opacity: 0,\n    },\n    enter: {\n      pointerEvents: 'all',\n      paddingTop: 36,\n      marginBottom: 400,\n      opacity: 1,\n    },\n    leave: {\n      pointerEvents: 'none',\n      paddingTop: 0,\n      marginBottom: 0,\n      height: 0,\n      opacity: 0,\n    },\n    config: {\n      mass: 1,\n      tension: 100,\n      friction: 15,\n    },\n  });\n\n  return (\n    <div className={'Timeline'} ref={timelineRef}>\n      <div className=\"actions timeline fadeInUp\" onWheel={handleWheel}>\n        <div className={'wheel-buttons'}>\n          <div\n            className={'wheel-button left'}\n            onClick={handleClick.bind(this, 0)}\n          >\n            <FastForward />\n          </div>\n          <div\n            className={classnames('wheel-button', {active: play})}\n            onClick={setPlay.bind(this, !play)}\n          >\n            {play ? <Pause /> : <Play />}\n          </div>\n          <div\n            className=\"wheel-button\"\n            onClick={handleClick.bind(this, dates.length - 1)}\n          >\n            <FastForward />\n          </div>\n        </div>\n        <div className={'wheel'} ref={sliderRef}>\n          <div className=\"wheel__inner\">\n            <div className=\"wheel__slides\">\n              {slideValues.map(({className, style, slide}) => (\n                <div className={`wheel__slide`} style={style} key={slide}>\n                  <h5 {...{className}} onClick={handleClick.bind(this, slide)}>\n                    {formatSlideDate(dates[slide])}\n                  </h5>\n                  <div\n                    className={classnames('calendar-icon', {\n                      show: slide === sliderState?.absoluteSlide,\n                    })}\n                    onClick={setShowCalendar.bind(this, !showCalendar)}\n                  >\n                    {slide !== sliderState.size - 1 && (\n                      <CalendarIcon size={12} />\n                    )}\n                  </div>\n                </div>\n              ))}\n            </div>\n          </div>\n          {slideValues.map(\n            ({slide}) =>\n              Object.keys(timeline).includes(dates[slide]) && (\n                <h5\n                  className={classnames('highlight', {\n                    current: slide === sliderState?.absoluteSlide,\n                  })}\n                  key={slide}\n                >\n                  {timeline[dates[slide]]}\n                </h5>\n              )\n          )}\n        </div>\n      </div>\n      <Suspense fallback={<div />}>\n        {transitions(\n          (style, item) =>\n            item && (\n              <animated.div {...{style}}>\n                <Calendar {...{date, dates, slider}} />\n              </animated.div>\n            )\n        )}\n      </Suspense>\n    </div>\n  );\n}\n\nconst isEqual = (prevProps, currProps) => {\n  if (!equal(currProps.date, prevProps.date)) {\n    return false;\n  } else if (!equal(currProps.isTimelineMode, prevProps.isTimelineMode)) {\n    return false;\n  } else if (!equal(currProps.dates, prevProps.dates)) {\n    return false;\n  }\n  return true;\n};\n\nexport default memo(Timeline, isEqual);\n"]},"metadata":{},"sourceType":"module"}